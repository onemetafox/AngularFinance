<div class="checkbox check-primary">
    <input type="checkbox" value="2" id="checkbox5" ng-model="$ctrl.categoryQuery.all"
           ng-change="$ctrl.requestCategories()">
    <label for="checkbox5" class="bold">
        {{'customer.product.list.text.all' | translate}}
    </label>
</div>
<div class="row m-b-10">
    <div class="col-12">
        <div class="form-group">
            <input type="text" ng-model="$ctrl.query.keyword" placeholder="{{'customer.product.search' | translate}}" 
                    ng-change="$ctrl.getProducts($ctrl.query)" class="form-control">
        </div>
    </div>
</div>

<!-- <shimmer hide="$ctrl.categoriesLoaded" col="3"></shimmer> -->
<div id="cat1" class="row" ng-if="$ctrl.categoriesLoaded">
    <div ng-repeat="cat in $ctrl.categories"
         ui-sref="app.customer.product.view.products({categoryId:cat._id, supplierId:$ctrl.supplierId, isAll: $ctrl.requestAllCategories})"
         class="col-lg-4 col-sm-6 d-flex flex-column" ng-if="cat.childCategory.length>0">
        <!-- START ITEM -->
        <div class="card hover-layout-card social-card card-add-icon share share-other full-width m-b-30 d-flex flex-1 full-height no-border"
             data-social="item">
            <div class="card-content-container">
                <div class="bold h5">
                    {{currentLanguage.language === 'ar' ? cat.arabicName : cat.englishName}}
                </div>
            </div>
        </div>
    </div>
</div>
<div class="dataTables_wrapper">
    <list-pagination total-pages="$ctrl.categoriesTotalPages"
                     on-page-click="$ctrl.setPageCategories(pageNumber)"
                     current-page="$ctrl.categoryCurrentPage"></list-pagination>
</div>
<div ng-if="!$ctrl.isLoading"   class="row">
    <div ng-repeat="product in $ctrl.productList.products" class="col-lg-4 col-sm-6 d-flex flex-column"
         ui-sref="app.supplier.product.detail({productId : product._id})">
        <!-- START ITEM -->
        <div class="card social-card share share-other full-width m-b-10 d-flex flex-1 full-height no-border" data-social="item">
            <div class="card-header clearfix">
                <h5>{{ currentLanguage.language === 'ar'? product.arabicName : product.englishName }}</h5>
                <div class="price">1<span>{{currentLanguage.language === 'ar'? product.unit.arabicName :product.unit.englishName }}</span></div>
                <ul class="reactions">
                    <li><a href="#">{{product.price + ' '}}{{'customer.product.currency' | translate}}</a></li>
                </ul>
            </div>
            <div class="card-content flex-1" background="{{product.coverPhoto}}">
                <div class="card-image-overlay"></div>
            </div>
        </div>
        <!-- END ITEM -->
    </div>
</div>
<div ng-if="!$ctrl.isLoading && $ctrl.productList.products.length > 0" class="dataTables_wrapper p-b-20">
    <list-pagination total-pages="$ctrl.productsTotalPages" on-page-click="$ctrl.setProductsCurrentPage(pageNumber)" current-page="$ctrl.productCurrentPage"></list-pagination>
</div>

<script>
    $('[data-init="secondary-sidebar"]').each(function () {
        $(this).on('click', '.main-menu li a', function (e) {

            if ($(this).parent().children('.sub-menu') === false) {
                return;
            }
            var el = $(this);
            var parent = $(this).parent().parent();
            var li = $(this).parent();
            var sub = $(this).parent().children('.sub-menu');

            if (li.hasClass("open active")) {
                el.children('.arrow').removeClass("open active");
                sub.slideUp(200, function () {
                    li.removeClass("open active");
                });

            } else {
                parent.children('li.open').children('.sub-menu').slideUp(200);
                parent.children('li.open').children('a').children('.arrow').removeClass('open active');
                parent.children('li.open').removeClass("open active");
                el.children('.arrow').addClass("open active");
                sub.slideDown(200, function () {
                    li.addClass("open active");

                });
            }
            //e.preventDefault();
        });

    });

    $('[data-init="secondary-sidebar-toggle"]').each(function () {
        $(this).on("click", function (e) {
            var toggleRect = $(this).get(0).getBoundingClientRect();
            var menu = $('[data-init="secondary-sidebar"]');
            if (menu.hasClass("open")) {
                menu.removeClass("open");
                menu.removeAttr("style");
            }
            else {
                menu.addClass("open")
                var menuRect = menu.get(0).getBoundingClientRect();
                menu.css({
                    top: toggleRect.bottom,
                    'max-height': ($(window).height() - toggleRect.bottom),
                    left: $(window).width() / 2 - menuRect.width / 2,
                    'visibility': 'visible'
                });

            }
        })

    });
</script>